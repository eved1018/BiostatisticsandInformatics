df <- read.csv("/Users/evanedelstein/Desktop/School/2021/Spring2021/BTM-6000/Module6/Module 6 - NHANES subset.csv")> ls(df)[1] "age"          "CKD"          "CKD3"         "creatinine"   "eGFR"         "gender"       "MALE"        [8] "Patient_ID"   "SCr_elevated"> # Stages> df$CKD3_new <- ifelse(df$eGFR < 60,1,0 )> # > df$MALE <- ifelse(df$gender ==1,1,0)> df$SCr_elevated_new <- NA> df$SCr_elevated_new[df$MALE ==1] <- ifelse(df$creatinine[df$MALE ==1] > 1.2,1,0 )> df$SCr_elevated_new[df$MALE ==0] <- ifelse(df$creatinine[df$MALE ==0] > 1.1,1,0 )> #2 contigencey table  2x2 > df <- df[which(!is.na(df$SCr_elevated_new)),]> TP<-length(df$SCr_elevated_new[df$SCr_elevated_new==1 & df$CKD3_new == 1])> FP<-length(df$SCr_elevated_new[df$SCr_elevated_new==1 & df$CKD3_new == 0])> TN<-length(df$SCr_elevated_new[df$SCr_elevated_new==0 & df$CKD3_new == 0])> FN<-length(df$SCr_elevated_new[df$SCr_elevated_new==0 & df$CKD3_new == 1])> df$SCr_elevated_factor<-factor(df$SCr_elevated,labels=c("SCr elevated","SCr not elevated"),levels=1:0)> df$CKD_progressed<-factor(df$CKD3,labels=c("CKD3 or more","no CKD to CKD 2"),levels=1:0)> table1 <- table(df$SCr_elevated_factor,df$CKD_progressed)> Sensitivity<-table1[1,1] / (table1[2,1]+table1[1,1] )> Specificity<-table1[2,2] / (table1[2,2]+table1[1,2] )> PPV<-table1[1,1] / (table1[1,2]+table1[1,1] )> NPV<-table1[2,2] / (table1[2,2]+table1[2,1] )> Sensitivity[1] 0.8481013> Specificity[1] 0.9549763> PPV[1] 0.6380952> NPV[1] 0.9853301> #ROC CURVE > library(pROC)> roc1 <- roc(df$CKD_progressed,df$creatinine,plot=TRUE,grid=TRUE,print.auc=TRUE,ci=TRUE, show.thres=TRUE)Setting levels: control = CKD3 or more, case = no CKD to CKD 2Setting direction: controls > cases> ls(roc1) [1] "auc"                "call"               "cases"              "ci"                 "controls"           [6] "direction"          "fun.sesp"           "levels"             "original.predictor" "original.response" [11] "percent"            "predictor"          "response"           "sensitivities"      "specificities"     [16] "thresholds"        > roc1$aucArea under the curve: 0.962> roc1$ci95% CI: 0.9459-0.9782 (DeLong)> roc1$sensitivities  [1] 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000 [10] 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000 0.998815166 0.998815166 [19] 0.998815166 0.996445498 0.996445498 0.996445498 0.996445498 0.996445498 0.992890995 0.991706161 0.985781991 [28] 0.984597156 0.984597156 0.984597156 0.983412322 0.983412322 0.983412322 0.982227488 0.954976303 0.953791469 [37] 0.951421801 0.949052133 0.949052133 0.947867299 0.946682464 0.940758294 0.880331754 0.879146919 0.877962085 [46] 0.876777251 0.873222749 0.868483412 0.867298578 0.853080569 0.851895735 0.764218009 0.758293839 0.753554502 [55] 0.751184834 0.747630332 0.741706161 0.735781991 0.728672986 0.714454976 0.707345972 0.604265403 0.595971564 [64] 0.591232227 0.584123223 0.578199052 0.571090047 0.563981043 0.558056872 0.535545024 0.527251185 0.405213270 [73] 0.398104265 0.393364929 0.387440758 0.379146919 0.375592417 0.367298578 0.356635071 0.331753555 0.327014218 [82] 0.204976303 0.203791469 0.196682464 0.194312796 0.183649289 0.181279621 0.177725118 0.174170616 0.167061611 [91] 0.161137441 0.100710900 0.097156398 0.095971564 0.093601896 0.092417062 0.090047393 0.078199052 0.033175355[100] 0.031990521 0.030805687 0.029620853 0.026066351 0.022511848 0.021327014 0.003554502 0.002369668 0.000000000> roc1$specificities  [1] 0.00000000 0.01265823 0.02531646 0.03797468 0.05063291 0.06329114 0.07594937 0.08860759 0.10126582 0.12658228 [11] 0.16455696 0.17721519 0.18987342 0.20253165 0.24050633 0.25316456 0.30379747 0.31645570 0.32911392 0.41772152 [21] 0.43037975 0.44303797 0.45569620 0.46835443 0.49367089 0.50632911 0.62025316 0.62025316 0.63291139 0.64556962 [31] 0.64556962 0.65822785 0.68354430 0.68354430 0.77215190 0.77215190 0.78481013 0.78481013 0.79746835 0.79746835 [41] 0.79746835 0.81012658 0.86075949 0.86075949 0.87341772 0.88607595 0.89873418 0.89873418 0.91139241 0.92405063 [51] 0.92405063 0.97468354 0.97468354 0.97468354 0.97468354 0.97468354 0.97468354 0.97468354 0.97468354 0.98734177 [61] 0.98734177 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 [71] 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 [81] 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 [91] 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000[101] 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000 1.00000000> 