"0",""
"0","# 2A) t.test for association bewteen sleep and health in total population "
"0","#null <- mean BMI of those with and without sleep trouble is equal"
"0","#alt <- mean BMI of those with sleep trouble is greater than those who dont have sleep trouble "
"0",""
"0","ttest <- t.test(BMI~ SleepTrouble , data = df)"
"0","print(ttest)"
"1","
"
"1","	Welch Two Sample t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","BMI by SleepTrouble"
"1",""
"1","
"
"1","t = -5.4648, df = 3033.2, p-value = 5.009e-08"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-1.3931270 -0.6574077"
"1",""
"1","
"
"1","sample estimates:
"
"1"," mean in group No "
"1","mean in group Yes "
"1","
"
"1","         28.40592 "
"1","         29.43119 "
"1","
"
"1","
"
"0","#p-value = 5.043e-08 ; so we reject the null hyp and go wqith the alt "
"0",""
"0","# 2B) chi^2 test "
"0","#null <- no relationship between sleep trouble and reported Health "
"0","#alt. <- relationship between sleep trouble and reported Health"
"0",""
"0","table <- table(df$SleepTrouble, df$HealthGen)"
"0","chi_test <- chisq.test(table)"
"0","print(chi_test)"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 180.28, df = 4, p-value < 2.2e-16"
"1","
"
"1","
"
"0","table_2 <- table(df$SleepTrouble, df$Weight_factor)"
"0","chi_test_2 <- chisq.test(table_2)"
"0","print(chi_test)"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 180.28, df = 4, p-value < 2.2e-16"
"1","
"
"1","
"
"0","#2C) Anova+tukey "
"0","#hours slept per night is equivilent over weigth and health "
"0","anova_test <- aov(SleepHrsNight ~HealthGen, data = df )"
"0","print(summary(anova_test))"
"1","           "
"1","   Df"
"1"," Sum Sq"
"1"," Mean Sq"
"1"," F value"
"1"," Pr(>F)"
"1","    "
"1","
HealthGen  "
"1","    4"
"1","    248"
"1","   62.11"
"1","   35.04"
"1"," <2e-16"
"1"," ***"
"1","
Residuals  "
"1"," 6639"
"1","  11768"
"1","    1.77"
"1","        "
"1","       "
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","753 observations deleted due to missingness"
"1",""
"1","
"
"0","tukey <- TukeyHSD(anova_test)"
"0","print(tukey)"
"1","  Tukey multiple comparisons of means
"
"1","    "
"1",""
"1","95"
"1",""
"1","% family-wise confidence level
"
"1","
Fit: "
"1",""
"1","aov(formula = SleepHrsNight ~ HealthGen, data = df)"
"1",""
"1","

"
"1","$HealthGen
"
"1","               "
"1","       diff"
"1","        lwr"
"1","          upr"
"1","     p adj"
"1","
Vgood-Excellent"
"1"," -0.1495381"
"1"," -0.3020610"
"1","  0.002984725"
"1"," 0.0577906"
"1","
Good-Excellent "
"1"," -0.3196326"
"1"," -0.4684475"
"1"," -0.170817751"
"1"," 0.0000000"
"1","
Fair-Excellent "
"1"," -0.5360780"
"1"," -0.7130151"
"1"," -0.359140854"
"1"," 0.0000000"
"1","
Poor-Excellent "
"1"," -0.9891413"
"1"," -1.2954786"
"1"," -0.682803920"
"1"," 0.0000000"
"1","
Good-Vgood     "
"1"," -0.1700945"
"1"," -0.2758108"
"1"," -0.064378098"
"1"," 0.0001123"
"1","
Fair-Vgood     "
"1"," -0.3865399"
"1"," -0.5291472"
"1"," -0.243932561"
"1"," 0.0000000"
"1","
Poor-Vgood     "
"1"," -0.8396031"
"1"," -1.1274792"
"1"," -0.551727015"
"1"," 0.0000000"
"1","
Fair-Good      "
"1"," -0.2164454"
"1"," -0.3550797"
"1"," -0.077811045"
"1"," 0.0002011"
"1","
Poor-Good      "
"1"," -0.6695087"
"1"," -0.9554375"
"1"," -0.383579825"
"1"," 0.0000000"
"1","
Poor-Fair      "
"1"," -0.4530633"
"1"," -0.7545864"
"1"," -0.151540162"
"1"," 0.0004025"
"1","
"
"1","
"
"0","anova_test_2 <- aov(SleepHrsNight ~Weight_factor, data = df )"
"0","print(summary(anova_test_2))"
"1","             "
"1","   Df"
"1"," Sum Sq"
"1"," Mean Sq"
"1"," F value"
"1","  Pr(>F)"
"1","   "
"1","
Weight_factor"
"1","    3"
"1","     27"
"1","   9.034"
"1","   5.032"
"1"," 0.00175"
"1"," **"
"1","
Residuals    "
"1"," 7393"
"1","  13271"
"1","   1.795"
"1","        "
"1","        "
"1","   "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"0","tukey_2 <- TukeyHSD(anova_test_2)"
"0","print(tukey_2)"
"1","  Tukey multiple comparisons of means
"
"1","    "
"1",""
"1","95"
"1",""
"1","% family-wise confidence level
"
"1","
Fit: "
"1",""
"1","aov(formula = SleepHrsNight ~ Weight_factor, data = df)"
"1",""
"1","

"
"1","$Weight_factor
"
"1","                      "
"1","        diff"
"1","         lwr"
"1","         upr"
"1","     p adj"
"1","
Obese-Healthy         "
"1"," -0.13595584"
"1"," -0.22923464"
"1"," -0.04267704"
"1"," 0.0010420"
"1","
Overweight-Healthy    "
"1"," -0.06575576"
"1"," -0.16837607"
"1","  0.03686456"
"1"," 0.3525339"
"1","
Underweight-Healthy   "
"1","  0.10080910"
"1"," -0.31575463"
"1","  0.51737284"
"1"," 0.9251161"
"1","
Overweight-Obese      "
"1","  0.07020008"
"1"," -0.03391673"
"1","  0.17431689"
"1"," 0.3067743"
"1","
Underweight-Obese     "
"1","  0.23676495"
"1"," -0.18016997"
"1","  0.65369986"
"1"," 0.4624334"
"1","
Underweight-Overweight"
"1","  0.16656486"
"1"," -0.25255889"
"1","  0.58568861"
"1"," 0.7370244"
"1","
"
"1","
"
"0","# 3A) Contingency tables for subgroups "
"0","paramters <-c(""Gender"",""white"", ""HealthGen"",""Weight_factor"", ""Work"",""emplyed"",""Old"")"
"0","for (i in paramters){"
"0","  df_chi<-df[which(!is.na(df[[i]])),]"
"0","  formula <- as.formula(paste(""~"",i,""+SleepTrouble""))"
"0","  xt <- xtabs(formula , data=df_chi)"
"0","  contigency_table<- prop.table(xt)"
"0","  table <- addmargins(contigency_table)"
"0","  print(table)"
"0","}"
"1","        SleepTrouble
"
"1","Gender  "
"1","        No"
"1","       Yes"
"1","       Sum"
"1","
  female"
"1"," 0.3554144"
"1"," 0.1516831"
"1"," 0.5070975"
"1","
  male  "
"1"," 0.3859673"
"1"," 0.1069352"
"1"," 0.4929025"
"1","
  Sum   "
"1"," 0.7413816"
"1"," 0.2586184"
"1"," 1.0000000"
"1","
"
"1","           SleepTrouble
"
"1","white      "
"1","         No"
"1","        Yes"
"1","        Sum"
"1","
  not-white"
"1"," 0.27065026"
"1"," 0.06326889"
"1"," 0.33391916"
"1","
  White    "
"1"," 0.47073138"
"1"," 0.19534947"
"1"," 0.66608084"
"1","
  Sum      "
"1"," 0.74138164"
"1"," 0.25861836"
"1"," 1.00000000"
"1","
"
"1","           SleepTrouble
"
"1","HealthGen  "
"1","         No"
"1","        Yes"
"1","        Sum"
"1","
  Excellent"
"1"," 0.09677905"
"1"," 0.01926550"
"1"," 0.11604455"
"1","
  Vgood    "
"1"," 0.25737508"
"1"," 0.06577363"
"1"," 0.32314871"
"1","
  Good     "
"1"," 0.28145695"
"1"," 0.11348585"
"1"," 0.39494281"
"1","
  Fair     "
"1"," 0.09226370"
"1"," 0.04771222"
"1"," 0.13997592"
"1","
  Poor     "
"1"," 0.01204094"
"1"," 0.01384708"
"1"," 0.02588802"
"1","
  Sum      "
"1"," 0.73991571"
"1"," 0.26008429"
"1"," 1.00000000"
"1","
"
"1","             SleepTrouble
"
"1","Weight_factor"
"1","          No"
"1","         Yes"
"1","         Sum"
"1","
  Healthy    "
"1"," 0.289306476"
"1"," 0.092605110"
"1"," 0.381911586"
"1","
  Obese      "
"1"," 0.252264432"
"1"," 0.103420306"
"1"," 0.355684737"
"1","
  Overweight "
"1"," 0.191969717"
"1"," 0.060970664"
"1"," 0.252940381"
"1","
  Underweight"
"1"," 0.007841017"
"1"," 0.001622279"
"1"," 0.009463296"
"1","
  Sum        "
"1"," 0.741381641"
"1"," 0.258618359"
"1"," 1.000000000"
"1","
"
"1","            SleepTrouble
"
"1","Work        "
"1","         No"
"1","        Yes"
"1","        Sum"
"1","
  Looking   "
"1"," 0.02663602"
"1"," 0.01297999"
"1"," 0.03961601"
"1","
  NotWorking"
"1"," 0.23796647"
"1"," 0.11141157"
"1"," 0.34937804"
"1","
  Working   "
"1"," 0.47674419"
"1"," 0.13426176"
"1"," 0.61100595"
"1","
  Sum       "
"1"," 0.74134667"
"1"," 0.25865333"
"1"," 1.00000000"
"1","
"
"1","            SleepTrouble
"
"1","emplyed     "
"1","        No"
"1","       Yes"
"1","       Sum"
"1","
  Employed  "
"1"," 0.4767442"
"1"," 0.1342618"
"1"," 0.6110059"
"1","
  Unemployed"
"1"," 0.2646025"
"1"," 0.1243916"
"1"," 0.3889941"
"1","
  Sum       "
"1"," 0.7413467"
"1"," 0.2586533"
"1"," 1.0000000"
"1","
"
"1","         SleepTrouble
"
"1","Old      "
"1","         No"
"1","        Yes"
"1","        Sum"
"1","
  Over60 "
"1"," 0.17115047"
"1"," 0.07286738"
"1"," 0.24401785"
"1","
  Under60"
"1"," 0.57023117"
"1"," 0.18575098"
"1"," 0.75598215"
"1","
  Sum    "
"1"," 0.74138164"
"1"," 0.25861836"
"1"," 1.00000000"
"1","
"
"0","# 3B) t.test and chi-squere test for association bewteen sleep and health in different subgroups "
"0","#null <- mean BMI of those with and without sleep trouble is equal among subgroup "
"0","#alt <- mean BMI of those with sleep trouble is greater than those who dont have sleep trouble among subgroup"
"0",""
"0",""
"0",""
"0","Chisq_df <- data.frame()"
"0","ttest_df <- data.frame()"
"0",""
"0","t_test_strat <- function(df,column, value, comp){"
"0","  df<-df[which(!is.na(df[[column]])),]"
"0","  df_t <- df[which(df[[column]]== value),]"
"0","  n <- nrow(df_t)"
"0","  ttest <- t.test(BMI~ SleepTrouble , data = df_t)"
"0","  pval <- ttest$p.value #<- p-value "
"0","  alt_null <- ifelse(pval <= 0.05,""< 0.05"",""> 0.05"" ) "
"0","  diff_in_mean<-ttest$estimate[1]-ttest$estimate[2] #TODO Make absolte value "
"0","  LL_CI<-ttest$conf.int[1] # <- lower level for confidence interval "
"0","  UL_CI<-ttest$conf.int[2]"
"0","  diff <- paste(round(diff_in_mean,1),"" ("",round(LL_CI,1),"" to "",round(UL_CI,1),"")"",sep="""")"
"0","  # Populate the row"
"0","  t_row <- data.frame(group = value, t =ttest$statistic , P_value = alt_null, Diff_in_means = diff , means = paste(round(ttest$estimate[1],2) , "";"", round(ttest$estimate[2],2), n=n ) )"
"0","  table <- table(df_t$SleepTrouble, df_t[[comp]])"
"0","  chi_test <- chisq.test(table)"
"0","  c_pval <- chi_test$p.value #<- p-value "
"0","  c_alt_null <- ifelse(c_pval <= 0.05,""< 0.05"",""> 0.05"" ) "
"0","  c_row <- data.frame(group = value, t =chi_test$statistic , P_value = c_alt_null, n= n  )"
"0","  "
"0","  print(chi_test)"
"0","  print(ttest)"
"0","  results_list <- list(""t_row"" = t_row, ""c_row"" = c_row)"
"0","  return(results_list) "
"0","  "
"0","}"
"0","params <- list()"
"0","params[[1]] = c(""Gender"",""male"", ""female"")"
"0","params[[2]] = c(""white"",""White"",""not-white"")"
"0","params[[3]] = c(""emplyed"",""Employed"",""Unemployed"")"
"0","params[[4]] = c(""Old"",""Under60"",""Over60"")"
"0",""
"0","for (param in params) {"
"0","    column <- param[1]"
"0","    value_1 <- param[2]"
"0","    value_2 <- param[3]"
"0","    comp <-""Weight_factor"""
"0","    results_list <- t_test_strat(df,column,value_1,comp)"
"0","    #Add the row"
"0","    ttest_df <- rbind(ttest_df, results_list$t_row)"
"0","    Chisq_df <- rbind(Chisq_df, results_list$c_row,simulate.p.value = TRUE)"
"0","    "
"0","    results_list <- t_test_strat(df,column,value_2,comp)"
"0","    #Add the row"
"0","    ttest_df <- rbind(ttest_df, results_list$t_row)"
"0","    Chisq_df <- rbind(Chisq_df, results_list$c_row)"
"0","}"
"2","Chi-squared approximation may be incorrect"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 3.2094, df = 3, p-value = 0.3605"
"1","
"
"1","
"
"1","
"
"1","	Welch Two Sample t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","BMI by SleepTrouble"
"1",""
"1","
"
"1","t = -1.73, df = 1229.6, p-value = 0.08387"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-0.87998683  0.05526297"
"1",""
"1","
"
"1","sample estimates:
"
"1"," mean in group No "
"1","mean in group Yes "
"1","
"
"1","         28.58565 "
"1","         28.99802 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 30.119, df = 3, p-value = 1.303e-06"
"1","
"
"1","
"
"1","
"
"1","	Welch Two Sample t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","BMI by SleepTrouble"
"1",""
"1","
"
"1","t = -5.5015, df = 1908.2, p-value = 4.274e-08"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-2.0697724 -0.9818916"
"1",""
"1","
"
"1","sample estimates:
"
"1"," mean in group No "
"1","mean in group Yes "
"1","
"
"1","         28.21075 "
"1","         29.73658 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 14.038, df = 3, p-value = 0.002854"
"1","
"
"1","
"
"1","
"
"1","	Welch Two Sample t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","BMI by SleepTrouble"
"1",""
"1","
"
"1","t = -3.7667, df = 2501.5, p-value = 0.0001692"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-1.2041838 -0.3796542"
"1",""
"1","
"
"1","sample estimates:
"
"1"," mean in group No "
"1","mean in group Yes "
"1","
"
"1","         28.22707 "
"1","         29.01899 "
"1","
"
"1","
"
"2","Chi-squared approximation may be incorrect"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 19.915, df = 3, p-value = 0.0001768"
"1","
"
"1","
"
"1","
"
"1","	Welch Two Sample t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","BMI by SleepTrouble"
"1",""
"1","
"
"1","t = -4.8667, df = 620.55, p-value = 1.441e-06"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-2.788658 -1.185166"
"1",""
"1","
"
"1","sample estimates:
"
"1"," mean in group No "
"1","mean in group Yes "
"1","
"
"1","         28.71700 "
"1","         30.70391 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 14.838, df = 3, p-value = 0.001961"
"1","
"
"1","
"
"1","
"
"1","	Welch Two Sample t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","BMI by SleepTrouble"
"1",""
"1","
"
"1","t = -4.1289, df = 1488.5, p-value = 3.848e-05"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-1.4833873 -0.5278744"
"1",""
"1","
"
"1","sample estimates:
"
"1"," mean in group No "
"1","mean in group Yes "
"1","
"
"1","         28.36297 "
"1","         29.36860 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 8.0466, df = 3, p-value = 0.04506"
"1","
"
"1","
"
"1","
"
"1","	Welch Two Sample t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","BMI by SleepTrouble"
"1",""
"1","
"
"1","t = -3.4504, df = 1615.6, p-value = 0.0005742"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-1.5923481 -0.4381003"
"1",""
"1","
"
"1","sample estimates:
"
"1"," mean in group No "
"1","mean in group Yes "
"1","
"
"1","         28.48353 "
"1","         29.49875 "
"1","
"
"1","
"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 17.86, df = 3, p-value = 0.00047"
"1","
"
"1","
"
"1","
"
"1","	Welch Two Sample t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","BMI by SleepTrouble"
"1",""
"1","
"
"1","t = -4.8145, df = 2158.5, p-value = 1.578e-06"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-1.5049401 -0.6337848"
"1",""
"1","
"
"1","sample estimates:
"
"1"," mean in group No "
"1","mean in group Yes "
"1","
"
"1","         28.30762 "
"1","         29.37699 "
"1","
"
"1","
"
"2","Chi-squared approximation may be incorrect"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","table"
"1",""
"1","
"
"1","X-squared = 7.4372, df = 3, p-value = 0.05919"
"1","
"
"1","
"
"1","
"
"1","	Welch Two Sample t-test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","BMI by SleepTrouble"
"1",""
"1","
"
"1","t = -2.3956, df = 857.63, p-value = 0.0168"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","difference in means"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-1.5208061 -0.1510603"
"1",""
"1","
"
"1","sample estimates:
"
"1"," mean in group No "
"1","mean in group Yes "
"1","
"
"1","         28.73344 "
"1","         29.56937 "
"1","
"
"1","
"
"0","print(ttest_df)"
