"0","#(4) Regression analyses "
"0","#Logistic regression and AUC for prediction of binary health group from sleep trouble and hours slept per night. "
"0",""
"0","df<-df[which(!is.na(df$healthy)),]"
"0",""
"0","LOGREG <- function(df, IV_param, DV_param) {"
"0","  cutoff <- nrow(df)"
"0","  cut2 <- round(cutoff/2)"
"0","  cutplus <- cut2+1"
"0","  train <- df[1:cut2,]"
"0","  test <- df[cutplus:cutoff,]"
"0","  test_rows <- nrow(test)"
"0","  train_rows <- nrow(train)"
"0","  train <- head(train,nrow(test))"
"0","  formula <- as.formula(paste(IV_param,""~"",DV_param))"
"0","  print(formula)"
"0","  fit<-glm(formula ,data=train,family = binomial(""logit""))"
"0","  print(summary(fit))"
"0","  print(anova(fit,test=""LRT""))"
"0","  table<-cbind(exp(fit$coefficients),exp(confint(fit)))"
"0","  colnames(table)<-c(""OR"",""LL"",""UL"")"
"0","  print(table)"
"0","  "
"0","  "
"0","  predictions <- predict(fit,test)"
"0","  "
"0","  labels <- test$healthy"
"0","  pred <- prediction(predictions, labels)"
"0","  perf <- performance(pred, ""tpr"", ""fpr"")"
"0","  auc <- performance(pred, measure = ""auc"")"
"0","  auc_num <- auc@y.values[[1]]"
"0","  print(auc_num)"
"0","  plot(perf,"
"0","       lty=3,"
"0","       avg= ""threshold"","
"0","       colorize=TRUE,"
"0","       lwd= 3,"
"0","       main= ""Logistic Regreison ROC"","
"0","  )"
"0","  mtext(""prediction score cutoff"", side=4)"
"0","  mtext(paste(""[IV: "", IV_param, ""; DV:"",DV_param, ""]"" ), side=3)"
"0","  text(0.75,0.25, paste(""AUC: "",round(auc_num,3)), col = ""red"")"
"0","  plot(perf,"
"0","       lty=3,"
"0","       col=""grey78"","
"0","       add=TRUE)"
"0","  return(auc_num)"
"0","}"
"0","auc_num <- LOGREG(df,""healthy"",""SleepHrsNight"")"
"1","healthy ~ SleepHrsNight
"
"1","<environment: 0x7fedbcf9de48>
"
"1","
Call:
"
"1",""
"1","glm(formula = formula, family = binomial(""logit""), data = train)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","    Min  "
"1","     1Q  "
"1"," Median  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-3.1221  "
"1"," 0.1858  "
"1"," 0.2273  "
"1"," 0.2777  "
"1"," 0.6047  "
"1","
"
"1","
Coefficients:
"
"1","             "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)  "
"1","  0.79137"
"1","    0.43582"
"1","   1.816"
"1","   0.0694"
"1"," .  "
"1","
SleepHrsNight"
"1","  0.40746"
"1","    0.06841"
"1","   5.956"
"1"," 2.58e-09"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 897.59  on 3321  degrees of freedom
"
"1",""
"1","Residual deviance: 863.89  on 3320  degrees of freedom
"
"1","AIC: "
"1",""
"1","867.89"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
"1","Analysis of Deviance Table

Model: binomial, link: logit

Response: healthy

Terms added sequentially (first to last)

"
"1","
"
"1","             "
"1"," Df"
"1"," Deviance"
"1"," Resid. Df"
"1"," Resid. Dev"
"1","  Pr(>Chi)"
"1","    "
"1","
NULL         "
"1","   "
"1","         "
"1","      3321"
"1","     897.59"
"1","          "
"1","    "
"1","
SleepHrsNight"
"1","  1"
"1","     33.7"
"1","      3320"
"1","     863.89"
"1"," 6.429e-09"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"2","Waiting for profiling to be done...
"
"1","             "
"1","       OR"
"1","        LL"
"1","       UL"
"1","
(Intercept)  "
"1"," 2.206412"
"1"," 0.9585228"
"1"," 5.303796"
"1","
SleepHrsNight"
"1"," 1.502996"
"1"," 1.3130552"
"1"," 1.717421"
"1","
"
"1","[1]"
"1"," 0.6332842"
"1","
"
